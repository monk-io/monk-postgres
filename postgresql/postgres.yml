---
namespace: postgresql

base:
  defines: runnable
  metadata:
    name: PostgreSQL
    description: PostgreSQL is a powerful, open source object-relational database system with over 30 years of active development that has earned it a strong reputation for reliability, feature robustness, and performance.
    website: https://www.postgresql.org
    publisher: monk.io
    icon: https://www.postgresql.org/media/img/about/press/elephant.png
    private: true
  variables:
    image_tag:
      type: string
      value: 12.2
    postgres_password:
      env: POSTGRES_PASSWORD
      type: string
      value: adminpassword
    db_username:
      env: POSTGRES_USER
      type: string
      value: monk
    db_name:
      env: POSTGRES_DB
      type: string
      value: monk
    volume_data:
      type: string
      value: <- `${monk-volume-path}/postgres`
  containers:
    postgres:
      paths:
        - <- `${volume_data}/db1:/var/lib/postgresql/data`
      image: postgres
      image-tag: <- `${image_tag}`

db:
  defines: runnable
  inherits: postgresql/common
  metadata:
    private: false
  containers:
    postgres:
      ports:
        - 5432:5432
  services:
    postgres-svc:
      container: postgres
      port: 5432
      protocol: tcp
    postgres-ext:
      container: postgres
      host-port: 5432
      port: 5432
      protocol: tcp
